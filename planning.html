

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Planning &mdash; L5Kit 1.3.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Simulation" href="simulation.html" />
    <link rel="prev" title="Prediction" href="prediction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> L5Kit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting started</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prediction.html">Prediction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Planning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#notebook-tutorial">Notebook Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#training-notebook">Training Notebook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#open-loop-evaluation-notebook">Open-Loop Evaluation Notebook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#closed-loop-evaluation-notebook">Closed-Loop Evaluation Notebook</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#video-tutorial">Video Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="simulation.html">Simulation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="competitions.html">Competitions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how_to_contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">L5Kit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Planning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/planning.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="planning">
<span id="id1"></span><h1>Planning<a class="headerlink" href="#planning" title="Permalink to this headline">¶</a></h1>
<p>Planning is an essential piece of the Autonomous Vehicles (AV) stack.</p>
<p>In this series of notebooks you will train and evaluate a data-driven ML policy.</p>
<p><strong>Before starting, please download the Lyft L5 Prediction Dataset 2020 and follow the instructions to correctly organise it.</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://self-driving.lyft.com/level5/prediction/">Lyft L5 Prediction Dataset 2020</a></p></li>
<li><p><a class="reference external" href="https://github.com/lyft/l5kit#download-the-datasets">Instructions</a></p></li>
</ul>
<p>Training an effective ML policy for planning can take several hours on the best performing hardware.
For this reason, we provide trained models you can experiment with in our evaluations notebooks,
without requiring to train one yourself. Still, we suggest you to go through the training notebook we provide,
as it contains key insights on how to effectively train an ML policy for planning.</p>
<div class="section" id="notebook-tutorial">
<h2>Notebook Tutorial<a class="headerlink" href="#notebook-tutorial" title="Permalink to this headline">¶</a></h2>
<p>We provide 3 notebooks for a deep dive into planning for a Self Driving Vehicle (SDV).</p>
<div class="section" id="training-notebook">
<h3>Training Notebook<a class="headerlink" href="#training-notebook" title="Permalink to this headline">¶</a></h3>
<p>You can train your first ML policy for planning using our <a class="reference external" href="https://github.com/lyft/l5kit/blob/master/examples/planning/train.ipynb">training notebook</a></p>
<a class="reference external image-reference" href="https://colab.research.google.com/github/lyft/l5kit/blob/master/examples/planning/train.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<p>In this notebook you are going to train your own ML policy to fully control a Self Driving Vehicle (SDV). You will train your model using the Lyft Prediction Dataset and L5Kit.</p>
<p>The policy will be a deep neural network (DNN) which will be invoked by the SDV to obtain the next command to execute.</p>
<p>More in details, you will be working with a CNN architecture based on ResNet50.</p>
<img alt="model" src="_images/model.svg" /><div class="section" id="inputs">
<h4>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline">¶</a></h4>
<p>The network will get a BEV of the scene surrounding the SDV as the only input. This has been rasterised in a fixed grid image to comply with the CNN input. L5Kit is shipped with various rasterisers. Each one of them captures different aspects of the scene (e.g. lanes or satellite view).</p>
<p>This input representation is very similar to the one used in the <a class="reference external" href="https://www.kaggle.com/c/lyft-motion-prediction-autonomous-vehicles/overview">prediction competition</a>. Please refer to our <a class="reference external" href="https://github.com/lyft/l5kit/blob/master/examples/agent_motion_prediction/agent_motion_prediction.ipynb">competition baseline notebook</a>
and our <a class="reference external" href="https://github.com/lyft/l5kit/blob/master/examples/visualisation/visualise_data.ipynb">data format notebook</a> if you want to learn more about it.</p>
</div>
<div class="section" id="outputs">
<h4>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h4>
<p>The network outputs the driving signals required to fully control the SDV. In particular, this is a trajectory of XY and yaw displacements which can be used to move and steer the vehicle.</p>
<p>After enough training, your model will be able to drive the SDV along a specific route. Among others, it will do lane-following while respecting traffic lights.</p>
</div>
<div class="section" id="pre-trained-models">
<h4>Pre-Trained Models<a class="headerlink" href="#pre-trained-models" title="Permalink to this headline">¶</a></h4>
<p>We provide a collection of pre-trained models you can experiment with and use in your own experiments.
Please refer to the training notebook for additional details and download links.</p>
</div>
</div>
<div class="section" id="open-loop-evaluation-notebook">
<h3>Open-Loop Evaluation Notebook<a class="headerlink" href="#open-loop-evaluation-notebook" title="Permalink to this headline">¶</a></h3>
<p>You can evaluate your model in the open-loop setting using our <a class="reference external" href="https://github.com/lyft/l5kit/blob/master/examples/planning/open_loop_test.ipynb">open-loop evaluation notebook</a></p>
<a class="reference external image-reference" href="https://colab.research.google.com/github/lyft/l5kit/blob/master/examples/planning/open_loop_test.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<div class="section" id="what-is-open-loop-evaluation">
<h4>What is open-loop evaluation?<a class="headerlink" href="#what-is-open-loop-evaluation" title="Permalink to this headline">¶</a></h4>
<p>In open-loop evaluation we evaluate our model prediction as we follow the annotated ground truth.</p>
<p>In each frame, we compare the predictions of our model against the annotated ground truth. This can be done with different metrics.</p>
<p><strong>Regardless of the metric used, this evaluation protocol doesn’t modify the future locations according to the model’s predictions.</strong></p>
<img alt="open-loop" src="_images/open-loop.svg" /></div>
</div>
<div class="section" id="closed-loop-evaluation-notebook">
<h3>Closed-Loop Evaluation Notebook<a class="headerlink" href="#closed-loop-evaluation-notebook" title="Permalink to this headline">¶</a></h3>
<p>You can evaluate your model in the closed-loop setting using our <a class="reference external" href="https://github.com/lyft/l5kit/blob/master/examples/planning/closed_loop_test.ipynb">closed-loop evaluation notebook</a></p>
<a class="reference external image-reference" href="https://colab.research.google.com/github/lyft/l5kit/blob/master/examples/planning/closed_loop_test.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a>
<p>In this notebook you are going to evaluate a CNN-based policy to control the SDV with a protocol named <em>closed-loop</em> evaluation.</p>
<div class="section" id="what-is-closed-loop-evaluation">
<h4>What is closed-loop evaluation?<a class="headerlink" href="#what-is-closed-loop-evaluation" title="Permalink to this headline">¶</a></h4>
<p>In closed-loop evaluation the model is in <strong>full control of the SDV</strong>. At each time step, we predict the future trajectory and then move the AV to the first of the model’s predictions.</p>
<p>We refer to this process with the terms <strong>forward-simulate</strong> or <strong>unroll</strong>.</p>
<img alt="closed-loop" src="_images/closed-loop.svg" /></div>
</div>
</div>
<div class="section" id="video-tutorial">
<h2>Video Tutorial<a class="headerlink" href="#video-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Check out this short tutorial that describes the task of planning for autonomous driving</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Jygsh17QbxY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="simulation.html" class="btn btn-neutral float-right" title="Simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="prediction.html" class="btn btn-neutral float-left" title="Prediction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Level 5.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>